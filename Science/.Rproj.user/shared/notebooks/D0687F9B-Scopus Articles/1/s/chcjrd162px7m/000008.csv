"0",""
"0","ASJC_list <- c(""2735"", ""3312"") # include your ASJC code. if you want to look at more than one code, you should separate them like this c(""code1"", ""code2"")"
"0",""
"0","#this code will look for both all articles within a code"
"0","#and articles within a code on the particular prolem"
"0",""
"0","if (""articles_by_asjc.csv"" %in% files){"
"0","  #read existing file, if any"
"0","  articles_by_asjc <- read.csv(""articles_by_asjc.csv"")"
"0","} else {"
"0","  #create empty df"
"0","  articles_by_asjc <- tibble(year = c(year_start:year_end), asjc = list(ASJC_list), total=0, n=0) %>%"
"0","    unnest(asjc)"
"0","  "
"0","  #run search by year"
"0","  for (i in 1:nrow(articles_by_asjc)){"
"0","    year = articles_by_asjc$year[i]"
"0","    asjc = articles_by_asjc$asjc[i]"
"0","    "
"0","    #look for total articles"
"0","    call <- paste0(url,""%28+SUBJTERMS+%28+"",asjc,""+%29+AND+PUBYEAR+IS+"",year,""+%29&apikey="",key)"
"0","    ans <- fromJSON(call)"
"0","    articles_by_asjc$total[i] <- as.integer(ans$`search-results`$`opensearch:totalResults`) "
"0","    "
"0","    #look for articles on topic"
"0","    call <- paste0(url,""%28+"",query,""+AND+SUBJTERMS+%28+"",asjc,""+%29+AND+PUBYEAR+IS+"",year,""+%29&apikey="",key)"
"0","    ans <- fromJSON(call)"
"0","    articles_by_asjc$n[i] <- as.integer(ans$`search-results`$`opensearch:totalResults`) "
"0","  }"
"0","  "
"0","  articles_by_asjc <- articles_by_asjc %>%"
"0","    mutate(prop = n/total)"
"0","  "
"0","  write.csv(articles_by_asjc, ""articles_by_asjc.csv"")"
"0",""
"0","}"
